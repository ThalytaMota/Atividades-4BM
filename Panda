import pandas as pd

# 01. Ler arquivo CSV

try:
    df = pd.read_csv('dados.csv')
    print("ğŸ“„ Arquivo 'dados.csv' carregado com sucesso!")
except FileNotFoundError:
    print("âš ï¸ Arquivo 'dados.csv' nÃ£o encontrado. Vamos criar um novo DataFrame para demonstraÃ§Ã£o.")
    df = pd.DataFrame({
        'Nome': ['Mariany', 'Thalyta', 'Thamires', 'Arthur', 'Nicoly'],
        'Idade': [17, 18, 19, 17, 20],
        'Nota': [8.5, 6.0, 9.2, 5.8, 7.5]
    })

print("\nPrimeiras linhas do DataFrame:")
print(df.head())

# 02. Criar e salvar DataFrame

dados = {
    'Nome': ['Mariany', 'Thalyta', 'Thamires', 'Arthur', 'Nicoly'],
    'Idade': [17, 18, 19, 17, 20],
    'Nota': [8.5, 6.0, 9.2, 5.8, 7.5]
}
df = pd.DataFrame(dados)

df.to_csv('alunos.csv', index=False)
print("\nğŸ’¾ DataFrame criado e salvo como 'alunos.csv'.")


# 03. SeleÃ§Ã£o de colunas

print("\nğŸ¯ Coluna 'Nome':")
print(df['Nome'])

print("\nğŸ¯ Colunas 'Nome' e 'Nota':")
print(df[['Nome', 'Nota']])

# 04. SeleÃ§Ã£o de linhas (loc / iloc)

print("\nğŸ” Linha com Ã­ndice 2 (usando loc):")
print(df.loc[2])

print("\nğŸ” Linha na posiÃ§Ã£o 0 (usando iloc):")
print(df.iloc[0])

# 05. Filtragem de dados

# Filtrar alunos com nota maior que 7
aprovados = df[df['Nota'] > 7]
print("\nâœ… Alunos aprovados (Nota > 7):")
print(aprovados)


# 06. OrdenaÃ§Ã£o

ordenado = df.sort_values(by='Nota', ascending=False)
print("\nğŸ“Š Alunos ordenados por nota (maior para menor):")
print(ordenado)

# 07. EstatÃ­sticas bÃ¡sicas

print("\nğŸ“ˆ EstatÃ­sticas bÃ¡sicas:")
print(df.describe())

# 08. Adicionar coluna

df['SituaÃ§Ã£o'] = df['Nota'].apply(lambda x: 'Aprovado' if x >= 7 else 'Reprovado')
print("\nğŸ†• DataFrame com nova coluna 'SituaÃ§Ã£o':")
print(df)

# 09. Atualizar dados

df.loc[df['Nome'] == 'Mariany', 'Nota'] = 7.0

df['SituaÃ§Ã£o'] = df['Nota'].apply(lambda x: 'Aprovado' if x >= 7 else 'Reprovado')

print("\nâœï¸ Nota do Mariany atualizada para 7.0 e situaÃ§Ã£o revisada:")
print(df[df['Nome'] == 'Mariany'])


# 10. Exportar aprovados

aprovados = df[df['SituaÃ§Ã£o'] == 'Aprovado']
aprovados.to_csv('aprovados.csv', index=False)

print("\nğŸ“‚ Arquivo 'aprovados.csv' exportado com sucesso!")
